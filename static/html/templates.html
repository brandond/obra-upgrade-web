<script type="text/html" id="index">
  <div class="card py-1 mb-2">
    <p>Cool stuff to improve your rest day experience. Result notifications, upgrade points, race rankings, etc.</p>
  </div>

  <div class="card bg-light py-1 mb-2" id="recent">
    <h5 class="card-title">Recent Events</h5>
    <nav class="nav flex-column bg-secondary nav-pills" data-bind="foreach: { data: eventsRecent, as: 'event' }">
      <a class="nav-link text-light py-0"
         data-bind="text: event.name,
                    attr: { href: '/event/' + event.id,
                            title: event.date + ' ' + (event.series && event.series.name) }">Name</a>
    </nav>
  </div>
  <div class="card bg-light py-1 mb-2" id="sandbaggers" data-bind="visible: upgradesRecent().length">
    <h5 class="card-title">Top Upgrades</h5>
    <table class="table table-sm mx-auto text-left bg-secondary mb-0">
      <tbody data-bind="foreach: { data: upgradesRecent, as: 'points' }">
        <tr class="position-relative">
          <td>
            <a class="text-light stretched-link" data-bind="text: points.person.name, attr: { href: '/person/' + points.person.id }">Name</a>
          </td>
          <td class="text-light" data-bind="text: points.sum_value + ' Points'">Points</td>
          <td class="text-light" data-bind="text: Math.min(...points.sum_categories) + ' &#x21FE; ' + (Math.min(...points.sum_categories) - 1)">Category</td>
        </tr>
      </tbody>
    </table>
  </div>
</script>

<script type="text/html" id="search">
  <h2>Search</h2>
  <div class="alert-warning col-md-8 mx-auto" data-bind="hidden: searchResults().length">
    No Matching OBRA Members</td>
  </div>
  <table class="table table-sm col-md-8 mx-auto text-left" data-bind="visible: searchResults().length">
    <thead>
      <tr>
        <th>Name</th>
        <th>Team</th>
      </tr>
    </thead>
    <tbody data-bind="foreach: { data: searchResults, as: 'person' }">
      <tr>
        <td><a data-bind="attr: { href: '/person/' + person.id }, text: person.name">Name</a></td>
        <td data-bind="text: person.team_name">Team</td>
      </tr>
    </tbody>
  </table>
</script>

<script type="text/html" id="event">
  <div class="w-100 d-inline-block" data-bind="with: eventResults, as: 'event'">
    <h2 data-bind="text: event.name">Event Name</h2>

    <ul class="nav nav-pills nav-light" data-bind="foreach: { data: event.races, as: 'race' }">
      <li class="nav-item">
        <a class="nav-link px-2 py-0 mx-auto" data-bind="text: race.name, attr: { href: '/event/' + event.id + '#race-' + race.id }">
          Race Name
        </a>
      </li>
    </ul>

    <div data-bind="foreach: { data: event.races, as: 'race' }">
      <div class="card bg-light mb-2">
        <h5 class="card-title mb-1" data-bind="text: race.name, attr: { id: 'race-' + race.id }">Race Name</h5>
        <table class="table table-sm bg-white text-left mb-2">
          <thead>
            <tr>
              <th class="col-1">#</th>
              <th class="col-1">Points</th>
              <th class="col-7 col-sm-3 col-lg-2">Name</th>
              <th class="col-0 col-sm-4 col-lg-3 d-none d-sm-table-cell">Team</th>
              <th class="col-1" data-bind="hidden: race.results[0].laps === undefined">Laps</th>
              <th class="col-1" data-bind="hidden: race.results[0].time === undefined">Time</th>
              <th class="col-0 col-sm-0 col-lg-3 d-none d-lg-table-cell">Notes</th>
            </tr>
          </thead>
          <tbody data-bind="foreach: { data: race.results, as: 'result' }">
            <tr>
              <td    data-bind="text: result.place">#</td>
              <td    data-bind="text: result.value || ''">Points</td>
              <td><a data-bind="text: result.person.name, attr: { href: '/person/' + result.person.id }">Name</a></td>
              <td    data-bind="text: result.person.team_name" class="d-none d-sm-table-cell">Team</td>
              <td    data-bind="text: result.laps, hidden: result.time === undefined" class="">Laps</td>
              <td    data-bind="text: moment.duration(result.time * 1000).format('h:mm:ss'), hidden: result.time === undefined" class="">Time</td>
              <td    data-bind="text: result.notes" class="d-none d-lg-table-cell">Notes</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <nav class="nav flex-column bg-dark fixed-bottom">
      <a class="nav-link py-0" data-bind="attr: { href: '/event/' + event.id + '#top' }">^</a>
    </nav>
  </div>
</script>

<script type="text/html" id="notifications">
  <div class="card">
    <h2 class="card-title">Notifications</h2>
    <p>Get a push notification on your mobile device when new race results are available.</p>
    <p><em>Coming Soon!</em></p>
  </div>
</script>

<script type="text/html" id="events">
  <div class="w-100 d-inline-block">

    <ul class="nav nav-tabs justify-content-center" id="discipline-tabs" role="tablist"
        data-bind="foreach: { data: eventsYears, as: 'year' }">
      <li class="nav-item" data-bind="css: { 'd-none d-sm-block': $index() > 4 }">
        <a class="nav-link" data-togle="tab" role="tab"
           data-bind="text: year,
                      css: { active: $root.pageContext().params.year == year },
                      attr: { href: '/events/' + year }">Year</a>
      </li>
    </ul>

    <ul class="nav nav-tabs justify-content-center" id="discipline-tabs" role="tablist"
        data-bind="foreach: { data: yearEvents, as: 'discipline' }, childrenComplete: $root.setActivePanel.bind($root, yearEvents())">
      <li class="nav-item" data-bind="css: { 'd-none d-sm-block': $index() > 2 }">
        <a class="nav-link" data-togle="tab" role="tab"
           data-bind="text: discipline.display,
                      click: $root.activePanel,
                      css: { active: discipline === $root.activePanel(), disabled: discipline.events.length == 0 },
                      attr: { 'id': discipline.name + '-tab', 'data-target': discipline.name }">Discipline</a>
      </li>
    </ul>

    <div class="tab-content w-100" id="discipline-tab-content"
         data-bind="foreach: { data: yearEvents, as: 'discipline' }">
      <div class="tab-pane fade" role="tabpanel"
           data-bind="attr: { 'id': discipline.name },
                      css: { active: discipline === $root.activePanel(), show: discipline === $root.activePanel() }">
        <table class="table table-sm w-100 text-left">
          <thead>
            <tr>
              <th>Name</th>
              <th>Date</th>
              <th>Series</th>
            </tr>
          </thead>
          <tbody data-bind="foreach: { data: events, as: 'event' }">
            <tr>
              <td><a data-bind="attr: { href: '/event/' + event.id }, text: event.name">Name</a></td>
              <td data-bind="text: event.date">Date</td>
              <td data-bind="text: event.series && event.series.name"></td>
            </tr>
          </tbody>
        </table>
      </div>  
    </div>
  </div>
</script>

<script type="text/html" id="person">
  <div class="w-100 d-inline-block" data-bind="with: personResults, as: 'person'">
    <h2 data-bind="text: 'Results for ' + person.name">Results For Name</h2>

    <ul class="nav nav-tabs justify-content-center" id="discipline-tabs" role="tablist"
        data-bind="foreach: { data: person.disciplines, as: 'discipline' }, childrenComplete: $root.setActivePanel.bind($root, person.disciplines)">
      <li class="nav-item" data-bind="css: { 'd-none d-sm-block': $index() > 2 }">
        <a class="nav-link" data-togle="tab" role="tab"
           data-bind="text: discipline.display,
                      click: $root.activePanel,
                      css: { active: discipline === $root.activePanel(), disabled: discipline.results.length == 0 },
                      attr: { 'id': discipline.name + '-tab', 'data-target': discipline.name }">Discipline</a>
      </li>
    </ul>

    <div class="tab-content" id="discipline-tab-content"
         data-bind="foreach: { data: person.disciplines, as: 'discipline' }">
      <div class="tab-pane fade" role="tabpanel"
           data-bind="attr: { 'id': discipline.name },
                      css: { active: discipline === $root.activePanel(), show: discipline === $root.activePanel() }">
        <table class="table table-sm text-left">
          <thead>
            <tr>
              <th class="col-2 col-sm-1 ">#</th>
              <th class="col-2 col-sm-1 ">Points</th>
              <th class="col-0 col-sm-1          d-none d-sm-table-cell">Total Pts</th>
              <th class="col-6 col-sm-4 col-md-2 ">Event</th>
              <th class="col-4 col-sm-4 col-md-2 ">Race</th>
              <th class="col-0 col-sm-0 col-md-1 d-none d-md-table-cell">Category</th>
              <th class="col-0 col-sm-1          d-none d-sm-table-cell">Date</th>
              <th class="col-0 col-sm-0 col-md-3 d-none d-md-table-cell">Notes</th>
            </tr>
          </thead>
          <tbody data-bind="foreach: { data: discipline.results, as: 'result' }">
            <tr>
              <td data-bind="text: result.place + '/' + result.race.starters">#</td>
              <td data-bind="text: result.value">Points</td>
              <td data-bind="text: result.sum_value" class="d-none d-sm-table-cell">Total Pts</td>
              <td><a data-bind="text: result.race.event.name, attr: { href: '/event/'+ result.race.event.id + '#' + result.race.id }">Event</a></td>
              <td data-bind="text: result.race.name">Race</td>
              <td data-bind="text: result.sum_categories.join('/')" class="d-none d-md-table-cell">Category</td>
              <td data-bind="text: result.race.date" class="d-none d-sm-table-cell">Date</td>
              <td data-bind="text: result.notes" class="d-none d-md-table-cell">Notes</td>
            </tr>
          </tbody>
        </table>
      </div>  
    </div>
  </div>
</script>

<script type="text/html" id="upgrades">
  <div class="w-100 d-inline-block" data-bind="with: upgradeResults, as: 'upgrades'">
    <h2>Upgrades Due</h2>

    <ul class="nav nav-tabs justify-content-center" id="discipline-tabs" role="tablist"
        data-bind="foreach: { data: upgrades, as: 'discipline' }, childrenComplete: $root.setActivePanel.bind($root, upgrades)">
      <li class="nav-item" data-bind="css: { 'd-none d-sm-block': $index() > 2 }">
        <a class="nav-link" data-togle="tab" role="tab"
           data-bind="text: discipline.display,
                      click: $root.activePanel,
                      css: { active: discipline === $root.activePanel(), disabled: discipline.results.length == 0 },
                      attr: { 'id': discipline.name + '-tab', 'data-target': discipline.name }">Discipline</a>
      </li>
    </ul>

    <div class="tab-content w-100" id="discipline-tab-content"
         data-bind="foreach: { data: upgrades, as: 'discipline' }">
      <div class="tab-pane fade" role="tabpanel"
           data-bind="attr: { 'id': discipline.name },
                      css: { active: discipline === $root.activePanel(), show: discipline === $root.activePanel() }">
        <table class="table table-sm col-md-8 mx-auto text-left">
          <thead>
            <tr>
              <th>Category</th>
              <th>Name</th>
              <th>Total Pts</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody data-bind="foreach: { data: discipline.results, as: 'result' }">
            <tr>
              <td data-bind="text: Math.min(...result.sum_categories) + ' &#x21FE; ' + (Math.min(...result.sum_categories) - 1)">Category</td>
              <td><a data-bind="text: result.person.name, attr: { href: '/person/' + result.person.id }">Name</a></td>
              <td data-bind="text: result.sum_value">Total Pts</td>
              <td data-bind="text: result.last_date">Last Date</td>
            </tr>
          </tbody>
        </table>
      </div>  
    </div>
  </div>
</script>
